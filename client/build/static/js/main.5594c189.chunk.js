(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{154:function(e,t,a){e.exports=a.p+"static/media/logo.f895a17f.png"},197:function(e,t,a){e.exports=a.p+"static/media/imageUpload.73a9f061.png"},206:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAF42lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDggNzkuMTY0MDM2LCAyMDE5LzA4LzEzLTAxOjA2OjU3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMCAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTA3LTIwVDEyOjUzOjM1KzA1OjMwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyMC0wNy0yMFQxMzowMToyMCswNTozMCIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0wNy0yMFQxMzowMToyMCswNTozMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHBob3Rvc2hvcDpDb2xvck1vZGU9IjMiIHBob3Rvc2hvcDpJQ0NQcm9maWxlPSJzUkdCIElFQzYxOTY2LTIuMSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1YjFkMWUwOS0xZWEwLTM4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"},230:function(e,t,a){e.exports=a(345)},265:function(e,t){},269:function(e,t,a){},270:function(e,t,a){},287:function(e,t,a){},288:function(e,t,a){e.exports=a.p+"static/media/login-logo-blk.6421f490.png"},290:function(e,t,a){},292:function(e,t,a){},293:function(e,t,a){},294:function(e,t,a){},295:function(e,t,a){},296:function(e,t,a){},297:function(e,t,a){},298:function(e,t,a){},299:function(e,t,a){},300:function(e,t,a){},301:function(e,t,a){},302:function(e,t,a){},303:function(e,t,a){},304:function(e,t,a){},318:function(e,t){},320:function(e,t){},328:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},339:function(e,t,a){e.exports=a.p+"static/media/calling.d2cab8e3.gif"},340:function(e,t,a){},341:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){"use strict";a.r(t);var n=a(13),l=a.n(n),c=a(1),o=a.n(c),r=a(10),i=a(199),s=a.n(i)()("http://localhost:7303"),u=a(42),d=a(19),m=a(385),E=a(7),p=a(74),f=a.n(p),g=a(391),h=a(393),v=a(376),b=a(387),y=a(59),C=a(60),S=a(76),O=a(85),I=a(203),A=a(58),j=a(126),R=(a(269),a(390));a(270);function P(e){var t=e.anchorEl,a=e.handleClose,n=e.handleDeletePost,l=e.post,c=Boolean(t),r=c?"DeletePostPopUp":void 0;return o.a.createElement("div",null,o.a.createElement(R.a,{id:r,open:c,anchorEl:t,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"}},o.a.createElement("div",{id:"postDelete-pop-container"},o.a.createElement("p",null,"Are you sure ?"),o.a.createElement("button",{onClick:function(){var e=null;e="Public"===l.postType?l.publicPostId:l._id,n(e,l.postType),a()}},o.a.createElement(j.a,null)))))}var T=function(e){var t=e.post,a=e.userId,n=e.handleDeletePost,l=Object(c.useState)(!1),r=Object(E.a)(l,2),i=r[0],s=r[1],u=Object(c.useState)(null),d=Object(E.a)(u,2),m=d[0],p=d[1],R=null;return(null===t||void 0===t?void 0:t.createdBy._id)===a&&(R=o.a.createElement(c.Fragment,null,o.a.createElement("button",{id:"postCardItem-edit",onClick:function(){s(!i)}},o.a.createElement(A.a,null)),o.a.createElement("button",{id:"postCardItem-delete",onClick:function(e){!function(e){p(e.currentTarget)}(e)}},o.a.createElement(j.a,null)),m&&o.a.createElement(P,{anchorEl:m,post:t,handleDeletePost:n,handleClose:function(){p(null)}}))),o.a.createElement("div",{id:"postCardItem-container"},o.a.createElement("div",{id:"postCardItem-title"},o.a.createElement(g.a,{id:"postCardItem-avatar",src:t.createdBy.profilePicUrl}),o.a.createElement("div",{id:"postCardItem-userDate"},o.a.createElement("h4",null,t.createdBy.username),o.a.createElement("p",null,f()(t.createdAt).format("LLL"))),o.a.createElement("div",{id:"postCardItem-miniAct"},o.a.createElement(v.a,{id:"postCardItem-control"},o.a.createElement(b.a,{disableUnderline:!0,value:t.postType,readOnly:!0,displayEmpty:!0},o.a.createElement(h.a,{id:'"postCardItem-select',value:"Private"},o.a.createElement(y.b,null)),o.a.createElement(h.a,{id:'"postCardItem-select',value:"Friends"},o.a.createElement(C.b,null)),o.a.createElement(h.a,{id:'"postCardItem-select',value:"Public"},o.a.createElement(S.a,null)))),R)),o.a.createElement("hr",null),o.a.createElement("div",{id:"postCardItem-post"},t.uploadPath&&o.a.createElement("img",{src:t.uploadPath,alt:t._id}),o.a.createElement("p",null,t.post)),o.a.createElement("hr",null),o.a.createElement("div",{id:"postCardItem-action"},o.a.createElement("button",null,o.a.createElement(O.c,null),o.a.createElement("span",null,t.isLiked.length)),o.a.createElement("button",null,o.a.createElement(O.a,null),o.a.createElement("span",null,t.isDisliked.length)),o.a.createElement("button",null,o.a.createElement(I.a,null),o.a.createElement("span",null,t.comments.length))))};var N=Object(r.b)((function(e){return{publicPosts:e.publicPosts,userId:e.login._id}}))((function(e){var t=e.publicPosts,a=e.userId;return o.a.createElement("div",null,o.a.createElement("h1",{style:{color:"white"}},"Welcome to Giggle-DisBot"),null===t||void 0===t?void 0:t.map((function(e){return o.a.createElement(T,{key:e._id,post:e,userId:a})})))})),w=a(127),M=a(204),k=a(205),_=a(217),D=a(216),B=a(15),L=a.n(B),U=localStorage.getItem("token"),x=function(e,t){return function(){L.a.post("/users/login",e).then((function(e){if(console.log("[PROMISE-token-login]",e.data),e.data.hasOwnProperty("error"))alert(e.data.error);else{var a=e.data.token;localStorage.setItem("token",a),alert("Login Successful"),t(),window.location.reload()}})).catch((function(e){return console.log(e)}))}},F=(a(287),function(e){Object(_.a)(n,e);var t=Object(D.a)(n);function n(){var e;Object(M.a)(this,n);for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return(e=t.call.apply(t,[this].concat(l))).state={email:"",password:"",show:!1},e.handleChange=function(t){e.setState(Object(w.a)({},t.target.name,t.target.value))},e.handleShow=function(){e.setState((function(e){return{show:!e.show}}))},e.handleSubmit=function(t){t.preventDefault();var a=e.state,n={email:a.email,password:a.password};console.log(n),e.props.dispatch(x(n,(function(){return e.props.history.push("/")})))},e}return Object(k.a)(n,[{key:"render",value:function(){return o.a.createElement("div",{className:"login-container"},o.a.createElement("div",{className:"login-logo"},o.a.createElement("img",{className:"login-logo-img",src:a(288),alt:"logo"})),o.a.createElement("form",{className:"login-form",onSubmit:this.handleSubmit},o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"email"},"Email"),o.a.createElement("input",{type:"email",name:"email",id:"email",value:this.state.email,onChange:this.handleChange,placeholder:"Enter your email"})),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"password"},"Password"),o.a.createElement("input",{type:this.state.show?"text":"password",name:"password",id:"password",value:this.state.password,onChange:this.handleChange,placeholder:"Password"})),o.a.createElement("div",{className:"checkbox-control"},o.a.createElement("div",null,o.a.createElement("input",{type:"checkbox",name:"show",id:"show",value:this.state.show,onClick:this.handleShow}),o.a.createElement("label",{htmlFor:"show"},"Show password")),o.a.createElement(u.b,{className:"link",to:"#"},"Forgot Password ?")),o.a.createElement("input",{className:"btn-login",type:"submit",value:"Sign In"}),o.a.createElement("small",null,"Don't have an account?",o.a.createElement(u.b,{className:"link",to:"/users/register"},"Sign Up"))))}}]),n}(c.Component)),Q=Object(r.b)()(F),Z=a(394),G=a(389),W=a(379),Y=(a(290),a(154)),z=a.n(Y),J=localStorage.getItem("token"),V=a(206),H=a.n(V);function X(e){return o.a.createElement("nav",{className:"navbar"},o.a.createElement("ul",{className:"navbar-nav"}," ",e.children," "))}function K(e){return o.a.createElement("li",{className:"nav-item ".concat(e.styleClassLi)},o.a.createElement(u.b,{className:"link-item ".concat(e.styleClass),to:e.to,onClick:e.onClick},e.name))}var q=Object(r.b)((function(e){return{user:e.login}}))((function(e){var t=Object(d.g)(),a=localStorage.getItem("token"),n=Object(c.useState)(""),l=Object(E.a)(n,2),r=l[0],i=l[1];return console.log("nav----",a),console.log("USER--------",e.user),o.a.createElement("div",null,a?o.a.createElement(X,null,o.a.createElement("img",{src:z.a,alt:"chatbot",className:"logo",onClick:function(){t.push("/")}}),o.a.createElement("form",{className:"search-bar",onSubmit:function(a){a.preventDefault();var n={searchUser:r};e.dispatch(function(e){return function(t){L.a.post("/users/search",e,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search]",e.data);var a=e.data;a.hasOwnProperty("errors")?(t({type:"CLEAR_SEARCH_RESULT"}),alert("".concat(a.message))):t({type:"SET_SEARCH_RESULT",payload:a})})).catch((function(e){return console.log(e)}))}}(n)),console.log("submit",r),t.push("/users/search")}},o.a.createElement(G.a,{className:"search-input",variant:"outlined",placeholder:"Search...",onChange:function(e){i(e.target.value)},value:r,InputProps:{startAdornment:o.a.createElement(Z.a,{position:"start"},o.a.createElement(y.c,null))}})),o.a.createElement(K,{to:"/users/notifications",styleClass:"badge",styleClassLi:"badge-li",name:o.a.createElement(W.a,{badgeContent:e.user.notifications.length,color:"secondary"},o.a.createElement(A.b,null))}),o.a.createElement(K,{to:"/users/posts",name:o.a.createElement("img",{src:H.a,alt:"postIcon"}),styleClass:"post-icon-nav"}),o.a.createElement(K,{to:"/users/friends",name:o.a.createElement(C.b,null)}),o.a.createElement(K,{to:"/users/chat",name:o.a.createElement(y.a,null)}),o.a.createElement(K,{to:"#",name:o.a.createElement(C.a,null),styleClass:"sign-out",onClick:function(){e.dispatch((function(e){localStorage.removeItem("token"),e({type:"CLEAR_USER_DATA"}),window.location.href="/"}))}})):o.a.createElement(X,null,o.a.createElement("img",{src:z.a,alt:"chatbot",className:"logo",onClick:function(){t.push("/")}}),o.a.createElement(K,{to:"/users/register",name:"Register",styleClassLi:"register",styleClass:"register-link"}),o.a.createElement(K,{to:"/users/login",name:"Sign In",styleClassLi:"sign-in",styleClass:"sign-in-link"})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("p",null,e.user._id&&o.a.createElement("span",null,e.user.username," - ",e.user.email)))})),$=a(86),ee=a(81),te=a(80),ae=a(386),ne=a(380),le=a(381),ce=a(382),oe=(a(292),Object(te.a)().shape({username:Object(te.c)().required().min(4,"minimum 4 characters"),email:Object(te.c)().email().required(),password:Object(te.c)().required().min(6,"minimum 6 characters"),confirmPass:Object(te.c)().oneOf([Object(te.b)("password")],"password must match")}));var re=Object(r.b)()((function(e){var t=Object(c.useState)(!1),a=Object(E.a)(t,2),n=a[0],l=a[1],r=function(){console.log(n,"showPass"),l(!n)},i=function(){e.history.push("/users/login")};return o.a.createElement("div",{className:"form-container"},o.a.createElement(ee.c,{initialValues:{username:"",password:"",confirmPass:"",email:""},validationSchema:oe,onSubmit:function(t,a){var n=a.setSubmitting,l=Object($.a)({},t);e.dispatch(function(e,t,a){return function(){L.a.post("/users/register",e).then((function(e){console.log("[PROMISE-login]",e.data);var n=e.data;n.hasOwnProperty("keyPattern")?1===n.keyPattern.email?(alert("email already exists"),a()):(alert("username already exists"),a()):(alert("Successfully registered"),a(),t())})).catch((function(e){return console.log("ERROR-login",e)}))}}(l,i,(function(){n(!1)})))}},(function(e){var t=e.isSubmitting,a=(e.values,e.errors),l=e.touched,i=e.isValid;return o.a.createElement(c.Fragment,null,o.a.createElement("div",{className:"form-register"},o.a.createElement("h1",null,"Register"),o.a.createElement(ee.b,null,o.a.createElement(ae.a,{marginBottom:2},o.a.createElement(ne.a,null,o.a.createElement(ee.a,{error:l.username&&Boolean(a.username),type:"text",name:"username",label:"Username",variant:"outlined",as:G.a,helperText:l.username&&a.username}))),o.a.createElement(ae.a,{marginBottom:2},o.a.createElement(ne.a,null,o.a.createElement(ee.a,{error:l.email&&Boolean(a.email),helperText:l.email&&a.email,type:"email",name:"email",label:"Email",variant:"outlined",as:G.a}))),o.a.createElement(ae.a,{marginBottom:2},o.a.createElement(ne.a,null,o.a.createElement(ee.a,{error:l.password&&Boolean(a.password),helperText:l.password&&a.password,type:n?"text":"password",name:"password",label:"Password",variant:"outlined",as:G.a,InputProps:{endAdornment:o.a.createElement(Z.a,{position:"end"},o.a.createElement(le.a,{onClick:r,className:"icon-svg"},n?o.a.createElement(S.b,null):o.a.createElement(S.c,null)))}}))),o.a.createElement(ae.a,{marginBottom:2},o.a.createElement(ne.a,null,o.a.createElement(ee.a,{error:l.confirmPass&&Boolean(a.confirmPass),helperText:l.confirmPass&&a.confirmPass,type:"password",name:"confirmPass",label:"Confirm Password",variant:"outlined",as:G.a}))),o.a.createElement(ce.a,{variant:"contained",color:"primary",type:"submit",className:"btn-register",disabled:t||!i},"SIGN UP"))))})))}));a(293);function ie(e){return o.a.createElement("div",{className:"card"},o.a.createElement("ul",{className:"card-wrap"},e.children))}function se(e){var t=e.img,a=e.username,n=e._id,l=e.isFriend,r=e.sendByMe,i=e.status,s=e.handleRequest,u=e.handleAccept,d=e.handleReject,m=e.handleRemove;return o.a.createElement("div",{className:"card-item-wrap"},o.a.createElement("img",{className:"avatar",src:t,alt:a}),o.a.createElement("li",{className:"card-item"},e.username),l?o.a.createElement(c.Fragment,null,r&&"Pending"===i?o.a.createElement("button",{className:"btn btn-cancel-friend",onClick:function(){s(n,l,r,i)}},"Cancel Request"):o.a.createElement(c.Fragment,null,"Accepted"===i?o.a.createElement("button",{className:"btn btn-remove-friend",onClick:function(){m(n)}},"Remove Friend"):"Pending"===i&&o.a.createElement(c.Fragment,null,o.a.createElement("button",{className:"btn btn-accept-friend",onClick:function(){u(n)}},"Accept"),o.a.createElement("button",{className:"btn btn-reject-friend",onClick:function(){d(n)}},"Reject")))):o.a.createElement("button",{className:"btn",onClick:function(){s(n,l)}},"Add Friend"))}var ue=Object(r.b)((function(e){return{results:e.searchResult}}))((function(e){var t=function(t,a,n,l){a?n&&"Pending"===l&&e.dispatch(function(e,t){return function(a){L.a.post("/users/search/cancelRequest/".concat(e),t,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search-cancel-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"SET_CANCEL_REQUEST",payload:t})}))}}(t)):e.dispatch(function(e,t){return function(a){L.a.post("/users/search/sendRequest/".concat(e),t,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search-send-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"SET_SENT_REQUEST",payload:t})}))}}(t))},a=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/search/acceptRequest/".concat(e),t,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search-accept-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"SET_ACCEPT_REQUEST",payload:t})}))}}(t))},n=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/search/rejectRequest/".concat(e),t,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search-reject-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"SET_REJECT_REQUEST",payload:t})}))}}(t))},l=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/search/removeFriend/".concat(e),t,{headers:{"x-auth":J}}).then((function(e){console.log("[PROMISE-search-remove-friend]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"SET_REMOVE_FRIEND",payload:t})}))}}(t))};return o.a.createElement("div",null,o.a.createElement(ie,null,e.results&&e.results.map((function(e){return o.a.createElement(se,{key:e._id,username:e.username,img:e.profilePicUrl,isFriend:e.isFriend,status:e.status&&e.status,handleRequest:t,_id:e._id,sendByMe:e.sendByMe,handleAccept:a,handleReject:n,handleRemove:l})}))))}));a(294);var de=function(e){return o.a.createElement("div",{id:"search-container"},o.a.createElement("input",{type:"text",placeholder:"Search"}))};a(295);var me=function(){return o.a.createElement("div",{id:"no-chat-layout"},o.a.createElement("div",{id:"no-chat-content"},o.a.createElement("h2",null,"No Chats"),o.a.createElement("p",null,"Currently you have no chats."),o.a.createElement("p",null,"To start a new chat click the button below."),o.a.createElement("button",{onClick:null},"New Chat")))},Ee=a(96),pe=a.n(Ee);a(296);var fe=function(e){var t,a,n=e.chat,l=e.isActive,c=e.onChatItemSelected,r=pe()("chat",{active:l}),i=(null===n||void 0===n?void 0:n.inbox.slice(0).sort((function(e,t){return e.createdAt.localeCompare(t.createdAt)}))).slice(0).pop();return i?(a=i.createdAt,t="text"===i.type?i.message:""):(a=null===n||void 0===n?void 0:n.createdAt,t=""),o.a.createElement("div",{className:r,onClick:function(){c(n)}},o.a.createElement("img",{src:n.info.profilePicUrl,alt:n.info.username}),o.a.createElement("div",{className:"title-text"},n.info.username),o.a.createElement("div",{className:"created-date"},f()(a).fromNow()),o.a.createElement("div",{className:"chat-message"},t))};a(297);var ge=function(e){var t=e.chats,a=e.selectedChat,n=e.onChatItemSelected,l=t.filter((function(e){return"Pending"!==e.status})),c=t&&l.map((function(e){var t=a&&e.info._id===a.info._id;return o.a.createElement(fe,{key:e.info._id,onChatItemSelected:n,isActive:t,chat:e})}));return o.a.createElement("div",{id:"chat-list"},c)};a(298);var he=function(){return o.a.createElement("div",{id:"new-message-container"})};a(299);var ve=function(e){var t=e.selectedChat,a=null===t||void 0===t?void 0:t.info._id,n=null,l=Object(d.g)();return t&&(n=o.a.createElement(c.Fragment,null,o.a.createElement("span",null,t.info.username),o.a.createElement("button",{id:"chatTitle-videoCall-btn",onClick:function(){l.push("/users/videocall/".concat(a))}},o.a.createElement(A.d,null)))),o.a.createElement("div",{id:"chat-title"},n)},be=(a(300),a(301),a(383)),ye=a(388),Ce=a(384),Se=a(347),Oe=(a(302),Object(be.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5]}}})));function Ie(e){var t=Oe(),a=o.a.useState(!1),n=Object(E.a)(a,2),l=n[0],r=n[1],i=e.message,s=e.modalStatus;Object(c.useState)((function(){r(s)}),[]);return o.a.createElement("div",null,o.a.createElement(ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:l,onClose:function(){r(!1),e.handleModalStatus()},closeAfterTransition:!0,BackdropComponent:Ce.a,BackdropProps:{timeout:500}},o.a.createElement(Se.a,{in:l},o.a.createElement("div",{className:t.paper},o.a.createElement("img",{className:"modal-img",src:i.message,alt:i._id})))))}var Ae=function(e){var t=e.isMyMessage,a=e.message,n=e.imageUrl,l=e.imageAlt,r=Object(c.useState)(!1),i=Object(E.a)(r,2),s=i[0],u=i[1],d=pe()("message-row",{"you-message":t,"other-message":!t}),m=t?null:o.a.createElement("img",{className:"avatar",src:n,alt:l}),p=function(){u(!s)},g=null;return"text"===a.type?g=o.a.createElement("div",{className:d},o.a.createElement("div",{className:"message-content"},m,o.a.createElement("div",{className:"message-text"},a.message),o.a.createElement("div",{className:"message-time"},f()(a.createdAt).format("MMMM Do YYYY, h:mm:ss a")))):"image/video"===a.type&&(g=o.a.createElement("div",{className:d},o.a.createElement("div",{className:"message-content"},m,o.a.createElement("img",{className:"message-file",src:a.message,alt:a._id,onClick:function(){p()}}),s&&o.a.createElement(Ie,{message:a,modalStatus:s,handleModalStatus:p}),o.a.createElement("div",{className:"message-time"},f()(a.createdAt).format("MMMM Do YYYY, h:mm:ss a"))))),o.a.createElement(c.Fragment,null,g)};var je=function(e){var t=e.selectedChat,a=null,n=Object(c.useRef)(null);return t&&t.inbox.length&&(a=t.inbox.sort((function(e,t){return-e.createdAt.localeCompare(t.createdAt)})).map((function(e){return o.a.createElement(Ae,{key:e._id,isMyMessage:e.isMyMessage,message:e,imageUrl:t.info.profilePicUrl,imageAlt:t.info.username})}))),Object(c.useEffect)((function(){n.current.scrollIntoView({behavior:"smooth"})}),[a]),o.a.createElement("div",{id:"chat-message-list"},o.a.createElement("div",{ref:n}),a)},Re=a(113);a(303);var Pe=function(e){var t=e.selectedChat,a=e.onMessageSubmitted,n=e.onFileUpload,l=Object(c.useState)(""),r=Object(E.a)(l,2),i=r[0],s=r[1],u=null;return t&&(u=o.a.createElement(c.Fragment,null,o.a.createElement("input",{type:"text",placeholder:"type a message",value:i,onChange:function(e){s(e.target.value)}}),o.a.createElement(Re.a,{onDrop:function(e){var t=new FormData;t.append("file",e[0]),t.append("type","image/video"),n(t)}},(function(e){var t=e.getRootProps,a=e.getInputProps;return o.a.createElement("section",null,o.a.createElement("div",t(),o.a.createElement("input",a()),o.a.createElement("button",{type:"button",id:"upload-btn"},o.a.createElement(A.c,null))))})),o.a.createElement("button",{type:"submit"},"Send"))),o.a.createElement("form",{id:"chat-form",onSubmit:function(e){e.preventDefault(),i.length>0&&(a(i),s(""))}},u)},Te=(a(304),localStorage.getItem("token")),Ne=function(e){return{type:"SET_SEND_MSG",payload:e}};var we=Object(r.b)((function(e){return{chats:e.login.friends,selectedChat:e.selectedChat,user:e.login}}))((function(e){var t=e.chats,a=e.selectedChat,n=null===a||void 0===a?void 0:a.info._id;console.log(t,"chatshell");var l=o.a.createElement(c.Fragment,null,o.a.createElement(me,null));return t.length>0&&(l=o.a.createElement(c.Fragment,null,o.a.createElement(je,{selectedChat:a}))),o.a.createElement("div",{id:"chat-container"},o.a.createElement(de,{chats:t}),o.a.createElement(ge,{onChatItemSelected:function(t){var a;e.dispatch((a=t,function(e){e(function(e){return{type:"SELECTED_ID",payload:e}}(a))})),console.log("selectedChat-----\x3e",t._id)},chats:t,selectedChat:a}),o.a.createElement(he,null),o.a.createElement(ve,{selectedChat:a}),l,o.a.createElement(Pe,{selectedChat:a,onMessageSubmitted:function(t){var a={message:t};console.log("SEND MESSAGE --------\x3e",n,t),e.dispatch(function(e,t){return function(a){L.a.post("/users/sendMsg/".concat(e),t,{headers:{"x-auth":Te}}).then((function(e){console.log("[PROMISE-send-msg]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a(Ne(t))})).catch((function(e){return console.log("[ERROR-send-msg]",e)}))}}(n,a))},onFileUpload:function(t){console.log(n,t,"file-upload"),e.dispatch(function(e,t){return function(a){L.a.post("/users/chats/upload/".concat(e),t,{headers:{"content-type":"multipart/form-data","x-auth":Te}}).then((function(e){console.log("[PROMISE-upload-file]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"UPLOAD_FILE",payload:t})})).catch((function(e){return console.log("[ERROR-upload-msg]",e)}))}}(n,t))}}))})),Me=localStorage.getItem("token");var ke=Object(r.b)((function(e){return{friends:e.login.friends}}))((function(e){var t=function(t,a,n,l){a&&n&&"Pending"===l&&e.dispatch(function(e,t){return function(a){L.a.post("/users/friends/cancelRequest/".concat(e),t,{headers:{"x-auth":Me}}).then((function(e){console.log("[PROMISE-friend-cancel-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"FRIEND_CANCEL_REQUEST",payload:t})}))}}(t))},a=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/friends/acceptRequest/".concat(e),t,{headers:{"x-auth":Me}}).then((function(e){console.log("[PROMISE-accept-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"FRIEND_ACCEPT_REQUEST",payload:t})}))}}(t))},n=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/friends/rejectRequest/".concat(e),t,{headers:{"x-auth":Me}}).then((function(e){console.log("[PROMISE-reject-request]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"FRIEND_REJECT_REQUEST",payload:t})}))}}(t))},l=function(t){e.dispatch(function(e,t){return function(a){L.a.post("/users/friends/removeFriend/".concat(e),t,{headers:{"x-auth":Me}}).then((function(e){console.log("[PROMISE-remove-friend]",e.data);var t=e.data;t.hasOwnProperty("errors")?alert(t.message):a({type:"FRIEND_REMOVE",payload:t})}))}}(t))},r=e.friends;return Object(c.useEffect)((function(){e.dispatch((function(e){L.a.get("/users/friendList",{headers:{"x-auth":Me}}).then((function(t){console.log("[PROMISE-update-friend-list]",t.data);var a=t.data;a.hasOwnProperty("errors")?alert(a.message):e({type:"UPDATE_FRIEND_LIST",payload:a})}))}))}),[]),o.a.createElement("div",null,o.a.createElement(ie,null,r&&r.map((function(e){return o.a.createElement(se,{key:e._id,username:e.info.username,img:e.info.profilePicUrl,isFriend:e.isFriend,status:e.status&&e.status,handleRequest:t,_id:e.info._id,sendByMe:e.sendByMe,handleAccept:a,handleReject:n,handleRemove:l})}))))})),_e=a(156),De=a.n(_e),Be=(a(328),a(211)),Le=a.n(Be),Ue=a(213),xe=a(212),Fe=(a(337),Object(be.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5]}}})));function Qe(e){var t=Fe(),a=o.a.useState(!1),n=Object(E.a)(a,2),l=n[0],r=n[1],i=e.view,s=e.modalStatus,u=e.message,m=Object(d.g)();Object(c.useState)((function(){r(i)}),[]);return o.a.createElement("div",null,o.a.createElement(ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:l,onClose:function(){r(!1)},closeAfterTransition:!0,BackdropComponent:Ce.a,BackdropProps:{timeout:500}},o.a.createElement(Se.a,{in:l},o.a.createElement("div",{id:"call-alert-modal",className:t.paper},o.a.createElement(xe.a,{id:"offline-icon"}),o.a.createElement("h2",null,u),o.a.createElement("button",{id:"close-alert",onClick:function(){s(),m.push("/users/chat")}},"Close")))))}var Ze=Object(r.b)((function(e){return{user:e.login,selectedChat:e.selectedChat,callState:e.call}}))((function(e){var t=Object(c.useRef)(),a=Object(c.useRef)(),n=Object(d.g)(),l=null,r=Object(c.useRef)(!1),i=Object(c.useRef)(!1),u=Object(c.useState)(!0),m=Object(E.a)(u,2),p=m[0],f=m[1],g=Object(c.useState)(),h=Object(E.a)(g,2),v=h[0],b=h[1],y=Object(c.useState)(!1),C=Object(E.a)(y,2),S=C[0],O=C[1],I=Object(c.useState)(),A=Object(E.a)(I,2),j=A[0],R=A[1],P=Object(c.useState)(""),T=Object(E.a)(P,2),N=T[0],w=T[1],M=Object(c.useState)(!1),k=Object(E.a)(M,2),_=k[0],D=k[1],B=Object(c.useState)(""),L=Object(E.a)(B,2),U=L[0],x=L[1],F=e.user,Q=e.callState,Z=Q.signal,G=e.match.params.id;console.log("params id --\x3e",G);var W=null===F||void 0===F?void 0:F._id,Y=Le.a.parse(e.location.search,{parseBooleans:!0});console.log(Y,"incoming-call query");var z,J,V=pe()("clientVideo",{"clientVideo-accepted":S}),H=null===Q||void 0===Q?void 0:Q.callReceiving;return Object(c.useEffect)((function(){return console.log(G,"---\x3eRID"),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(e){b(e),l=e,t.current&&(t.current.srcObject=e),Y.receiving&&(R(Z.signal),w(Z.from),console.log("[EFFECT-SET-RECEIVING-CALL]",N,j))})).catch((function(e){console.log(e),n.push("/users/chat")})),function(){console.log("streamVideo closed",l),l&&l.getTracks().forEach((function(e){"live"===e.readyState&&e.stop()})),console.log("[***INIT**]",G,W,H,"[CALL-END] --\x3e",r.current),i.current||r.current||(G?s.emit("connectionClosed",{to:G,from:W}):H&&s.emit("connectionClosed",{to:Z.from,from:W})),r.current=!1,i.current=!1,e.dispatch({type:"CLEAR_CALL_STATE"}),s.off("connectionClosed")}}),[]),Object(c.useEffect)((function(){if(console.log("++++++++++++++++++++++++++++++++++++CallPEER",G),G){return e.dispatch({type:"INCALL_INITIATE",payload:!0}),function(e){var t=new De.a({initiator:!0,trickle:!1,stream:v}),n=function(e){t.destroy(),console.log("data fail",e),setTimeout((function(){x(e.message),D(!0)}),2e3)};t.on("signal",(function(e){s.emit("callUser",{userToCall:G,signalData:e,from:W})})),t.on("stream",(function(e){a.current&&(a.current.srcObject=e)})),s.on("callAccepted",(function(e){O(!0),console.log("accepted signal",e),t.signal(e)})),s.on("not-reachable",n),s.on("callRejected",n),s.on("call-disconnected",n),s.on("callChannelClosed",n),s.on("callClosedByUser",n),s.on("caller engaged",(function(e){t.destroy(),console.log("data fail",e),setTimeout((function(){x(e.message),D(!0),i.current=!0}),2e3)}))}(),function(){s.off("callAccepted"),s.off("callRejected"),s.off("not-reachable"),s.off("call-disconnected"),s.off("callChannelClosed"),s.off("callClosedByUser"),s.off("caller engaged")}}}),[v,W,G,Y.connectId]),Object(c.useEffect)((function(){if(Y.attend&&N&&Y.connectId){!function(){O(!0);var e=new De.a({initiator:!1,trickle:!1,stream:v}),t=function(t){e.destroy(),console.log("data fail",t),setTimeout((function(){x(t.message),D(!0)}),2e3)};e.on("signal",(function(e){s.emit("acceptCall",{signal:e,to:N,from:W})})),e.on("stream",(function(e){a.current.srcObject=e})),e.signal(j),s.on("callChannelClosed",t),s.on("callClosedByUser",t)}()}return function(){s.off("callChannelClosed"),s.off("callClosedByUser")}}),[j,v,N,W,Y.connectId]),v&&(z=o.a.createElement("video",{className:V,playsInline:!0,muted:!0,ref:t,autoPlay:!0})),S&&(J=o.a.createElement("video",{controls:!0,id:"partnerVideo",ref:a,autoPlay:!0})),o.a.createElement("div",{id:"v-call-container"},_&&o.a.createElement(Qe,{view:p,modalStatus:function(){f(!1)},message:U}),o.a.createElement("div",{id:"call-video-box"},o.a.createElement("div",null,z),o.a.createElement("div",null,J)),o.a.createElement("button",{id:"call-end",onClick:function(){s.emit("endCallByUser",{user:F._id}),r.current=!0,setTimeout((function(){n.push("/users/chat")}),1500)}},o.a.createElement(Ue.a,null)))}));var Ge=function(e){return o.a.createElement("div",null,o.a.createElement(we,null),o.a.createElement(Ze,null))},We=(a(338),Object(be.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5]}}})));function Ye(e){var t=We(),n=o.a.useState(!1),l=Object(E.a)(n,2),r=l[0],i=l[1],s=e.view,u=e.modalStatus,d=e.name,m=e.pic,p=e.handleAttendCall,f=e.handleRejectCall;Object(c.useState)((function(){i(s)}),[]);return o.a.createElement("div",null,o.a.createElement(ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:r,onClose:function(){i(!1)},closeAfterTransition:!0,BackdropComponent:Ce.a,BackdropProps:{timeout:500}},o.a.createElement(Se.a,{in:r},o.a.createElement("div",{id:"call-modal",className:t.paper},o.a.createElement("img",{id:"call-img",src:a(339),alt:"calling"}),o.a.createElement("div",{id:"caller"},o.a.createElement("img",{id:"caller-avatar",src:m,alt:"name"}),o.a.createElement("h3",{id:"caller-name"},d)),o.a.createElement("div",{id:"call-btns"},o.a.createElement("button",{id:"acc-call",onClick:function(){u(),p()}},"Accept"),o.a.createElement("button",{id:"rej-call",onClick:function(){f(),u()}},"Reject"))))))}var ze=Object(r.b)((function(e){return{callState:e.call}}))((function(e){var t=Object(c.useState)(!1),a=Object(E.a)(t,2),n=a[0],l=a[1],r=Object(c.useState)(""),i=Object(E.a)(r,2),u=i[0],m=i[1],p=Object(c.useState)(""),f=Object(E.a)(p,2),g=f[0],h=f[1],v=Object(c.useState)({}),b=Object(E.a)(v,2),y=b[0],C=b[1],S=Object(c.useState)(!1),O=Object(E.a)(S,2),I=O[0],A=O[1],j=Object(c.useState)(""),R=Object(E.a)(j,2),P=R[0],T=R[1],N=e.callState,w=null===N||void 0===N?void 0:N.callReceiving,M=function(t){console.log("[VIDEO-SIGNAL]",t);var a={from:t.from,signal:t.signal};e.dispatch(function(e){return{type:"SAVE_SIGNAL",payload:e}}(a)),N.callInitiator||(e.dispatch({type:"INCALL_RECEIVING",payload:!0}),w||l(!0)),C(a),m(t.username),h(t.profilePicUrl);var n="/users/videoCall?from=".concat(t.from,"&connectId=").concat(t.connect_id,"&receiving=true&attend=true");T(n)};return Object(c.useEffect)((function(){return console.log("VideoCall listener fn() loaded"),s.on("call listener",M),function(){console.log("VideoCall listening closed"),s.off("call listener",M),I&&(A(!1),l(!1))}})),o.a.createElement("div",null,o.a.createElement(c.Fragment,null,n&&!I&&o.a.createElement(Ye,{modalStatus:function(){l(!1)},view:n,name:u,pic:g,handleAttendCall:function(){A(!0)},handleRejectCall:function(){e.dispatch({type:"CLEAR_CALL_STATE"}),s.emit("rejectCall",{from:y.from})}}),I&&o.a.createElement(d.a,{to:P})))}));var Je=Object(r.b)()((function(e){var t=function(t){console.log(t,"[MESSAGE_SERVER]"),e.dispatch(Ne(t))};return Object(c.useEffect)((function(){return console.log("socketFnMessages() connected on load"),s.on("server message listening",t),function(){console.log("socket listening closed"),s.off("server message listening",t)}}),[]),null})),Ve=(a(340),a(341),Object(be.a)((function(e){return{modal:{display:"flex",alignItems:"center",justifyContent:"center"}}})));function He(e){var t=Ve(),a=o.a.useState(!1),n=Object(E.a)(a,2),l=n[0],r=n[1],i=e.modalStatus,s=e.addPost;Object(c.useState)((function(){r(i)}),[]);return o.a.createElement("div",null,o.a.createElement(ye.a,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",className:t.modal,open:l,onClose:function(){r(!1),e.handleModalStatus()},closeAfterTransition:!0,BackdropComponent:Ce.a,BackdropProps:{timeout:500}},o.a.createElement(Se.a,{in:l},o.a.createElement("div",{id:"post-paper"},s))))}var Xe=a(215);a(343);function Ke(e){var t=e.anchorEl,a=e.handleClose,n=e.handleAddEmoji,l=Boolean(t),c=l?"EmojiPopUp":void 0;return o.a.createElement("div",null,o.a.createElement(R.a,{id:c,open:l,anchorEl:t,onClose:a,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},o.a.createElement(Xe.a,{title:"Pick your emoji\u2026",emoji:"point_up",onSelect:n})))}var qe=localStorage.getItem("token"),$e=function(e){return{type:"ADD_NEW_POST",payload:e}};function et(e){var t=e.user,n=e.handleDrop,l=e.fileUp,r=e.post,i=e.pType,s=e.handleClearFileUpload,u=e.handlePassPostData,d=e.handleSubmit,m=Object(c.useState)("Private"),p=Object(E.a)(m,2),f=p[0],I=p[1],A=Object(c.useState)(""),j=Object(E.a)(A,2),R=j[0],P=j[1],T=Object(c.useState)(null),N=Object(E.a)(T,2),w=N[0],M=N[1],k=Object(c.useState)(""),_=Object(E.a)(k,2),D=_[0],B=_[1];Object(c.useEffect)((function(){r&&(I(i),P(r))}),[]),console.log(!R.length,!Boolean(l),"check disabled");return Object(c.useEffect)((function(){u(R,f)}),[R,f]),o.a.createElement("div",{id:"add-post-container"},o.a.createElement("h1",null,"Create post"),o.a.createElement("hr",null),o.a.createElement("div",{id:"add-ava-user"},o.a.createElement(g.a,{id:"post-avatar",src:t.profileImg}),o.a.createElement("div",{id:"add-post-type"},o.a.createElement("h4",null,t.username),o.a.createElement(v.a,null,o.a.createElement(b.a,{id:"select-post-type",value:f,onChange:function(e){I(e.target.value)},displayEmpty:!0},o.a.createElement(h.a,{value:"Private"},o.a.createElement(y.b,null),"Only me"),o.a.createElement(h.a,{value:"Friends"},o.a.createElement(C.b,null),"Friends"),o.a.createElement(h.a,{value:"Public"},o.a.createElement(S.a,null),"Public"))))),l&&o.a.createElement("div",{id:"add-file-up"},o.a.createElement("img",{src:URL.createObjectURL(l),alt:"fileUp"}),o.a.createElement("button",{id:"add-file-up-close",onClick:s},"X")),o.a.createElement("div",{id:"add-post-wrapper"},o.a.createElement("textarea",{id:"add-post-text",style:{height:"".concat(D,"px")},type:"text",value:R,placeholder:"Whats on your mind,".concat(t.username," ?"),onChange:function(e){P(e.target.value),console.log(e.target),B(e.target.scrollHeight)}}),o.a.createElement(O.b,{id:"add-input-emoji",onClick:function(e){!function(e){M(e.currentTarget)}(e)}}),w&&o.a.createElement(Ke,{anchorEl:w,handleClose:function(e){M(null)},handleAddEmoji:function(e){P(R+e.native)}})),o.a.createElement("hr",null),o.a.createElement("div",{id:"add-post-action"},o.a.createElement(Re.a,{onDrop:n},(function(e){var t=e.getRootProps,n=e.getInputProps;return o.a.createElement("section",null,o.a.createElement("div",t(),o.a.createElement("input",n()),o.a.createElement("div",{id:"img-up-btn"},o.a.createElement("img",{src:a(197),alt:"imgUpIcon"}))))})),o.a.createElement("button",{id:"add-post-btn",onClick:d,disabled:!R.length&&!Boolean(l)},"Post")))}var tt=Object(r.b)((function(e){return{user:e.login}}))((function(e){var t=e.user,n=Object(c.useState)(!1),l=Object(E.a)(n,2),r=l[0],i=l[1],s=Object(c.useState)(null),u=Object(E.a)(s,2),d=u[0],m=u[1],p=Object(c.useState)(""),f=Object(E.a)(p,2),h=f[0],v=f[1],b=Object(c.useState)("Private"),y=Object(E.a)(b,2),C=y[0],S=y[1],O=function(e){m(e[0]),r||i(!r)},I=function(){i(!r)};return o.a.createElement("div",{id:"create-post-container"},r&&o.a.createElement(He,{modalStatus:r,handleModalStatus:I,addPost:o.a.createElement(et,{handleDrop:O,user:t,fileUp:d,post:h,pType:C,handleClearFileUpload:function(){m(null)},handlePassPostData:function(e,t){v(e),S(t)},handleSubmit:function(){console.log("[SUBMIT]",h,C,d);var t=new FormData;t.append("file",d),t.append("post",h),t.append("postType",C),e.dispatch(function(e){return function(t){L.a.post("/users/posts/new",e,{headers:{"x-auth":qe}}).then((function(e){console.log("[PROMISE-postNew]",e.data);var a=e.data;t($e(a))})).catch((function(e){return console.log(e)}))}}(t)),I(),m(null),v(""),S("Private")}})}),o.a.createElement("div",{id:"ava-input"},o.a.createElement(g.a,{id:"post-avatar",src:t.profileImg}),o.a.createElement("input",{id:"input-post",type:"text",placeholder:"Whats on your mind,".concat(t.username," ?"),readOnly:!0,onClick:I})),o.a.createElement("hr",null),o.a.createElement("div",{id:"post-action"},o.a.createElement(Re.a,{onDrop:O},(function(e){var t=e.getRootProps,n=e.getInputProps;return o.a.createElement("section",null,o.a.createElement("div",t(),o.a.createElement("input",n()),o.a.createElement("div",{id:"img-up-btn"},o.a.createElement("img",{src:a(197),alt:"imgUpIcon"}),"Image")))}))))}));var at=Object(r.b)((function(e){return{posts:e.login.posts,userId:e.login._id}}))((function(e){var t=e.posts,a=e.userId;console.log(t,"-----\x3e posts");var n=function(t,a){console.log("deletePost",t,a),e.dispatch(function(e,t,a){return function(n){L.a.put("/users/posts/".concat(t,"/").concat(e),a,{headers:{"x-auth":qe}}).then((function(e){console.log("[PROMISE-postDelete]",e.data);var t=e.data;n({type:"DELETE_POST",payload:t})})).catch((function(e){return console.log(e)}))}}(t,a))};return o.a.createElement("div",null,null===t||void 0===t?void 0:t.map((function(e){return o.a.createElement(T,{key:e._id,post:e,userId:a,handleDeletePost:n})})))}));var nt=function(){return o.a.createElement("div",null,o.a.createElement(tt,null),o.a.createElement(at,null))};var lt=Object(r.b)()((function(e){var t=function(t){console.log(t,"[POST_SERVER-PUBLIC]"),e.dispatch({type:"ADD_NEW_PUBLIC_POST",payload:t})},a=function(t){console.log(t,"[POST_SERVER-FRIEND]"),e.dispatch($e(t))};return Object(c.useEffect)((function(){return console.log("socketFnPosts() connected on load"),s.on("publicPost",t),s.on("addNewFriendPost",a),function(){console.log("socket listening closed"),s.off("publicPost",t),s.off("addNewFriendPost",a)}}),[]),null}));var ct=Object(r.b)((function(e){return{user:e.login}}))((function(e){var t=e.user;return Object(c.useEffect)((function(){s.emit("userId",{userId:t._id})}),[t._id]),o.a.createElement(u.a,null,o.a.createElement("div",null,o.a.createElement(q,null),o.a.createElement(ze,null),o.a.createElement(Je,null),o.a.createElement(lt,null),o.a.createElement(m.a,null,o.a.createElement(d.d,null,o.a.createElement(d.b,{exact:!0,path:"/",component:N}),o.a.createElement(d.b,{path:"/users/login",component:Q}),o.a.createElement(d.b,{path:"/users/register",component:re}),o.a.createElement(d.b,{path:"/users/search",component:ue}),o.a.createElement(d.b,{path:"/users/friends",component:ke}),o.a.createElement(d.b,{path:"/users/intercom",component:Ge}),o.a.createElement(d.b,{path:"/users/chat",component:we}),o.a.createElement(d.b,{path:"/users/videocall/:id",component:Ze}),o.a.createElement(d.b,{path:"/users/videocall/",component:Ze}),o.a.createElement(d.b,{path:"/users/posts/",component:nt})))))})),ot=a(100),rt=a(214),it={_id:"",username:"",email:"",profileImg:"",notifications:[],friends:[],posts:[]},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_DATA":return Object.assign({},e,{_id:t.payload._id,username:t.payload.username,email:t.payload.email,profileImg:t.payload.profilePicUrl,notifications:t.payload.notifications,friends:t.payload.friends,posts:t.payload.posts});case"SET_SEND_MSG":var a=e.friends.map((function(e){return e.info._id===t.payload._id?(e.inbox.push(t.payload.inbox),e):e}));return Object.assign({},e,{friends:a});case"UPLOAD_FILE":var n=e.friends.map((function(e){return e.info._id===t.payload._id?(e.inbox.push(t.payload.inbox),e):e}));return Object.assign({},e,{friends:n});case"UPDATE_FRIEND_LIST":return Object.assign({},e,{friends:t.payload});case"FRIEND_CANCEL_REQUEST":var l=e.friends.filter((function(e){return e.info._id!==t.payload._id}));return Object.assign({},e,{friends:l});case"FRIEND_ACCEPT_REQUEST":var c=e.friends.map((function(e){return e.info._id===t.payload._id?(e.status=t.payload.status,e.isFriend=t.payload.isFriend,e):e}));return Object.assign({},e,{friends:c});case"FRIEND_REJECT_REQUEST":var o=e.friends.filter((function(e){return e.info._id!==t.payload._id}));return Object.assign({},e,{friends:o});case"FRIEND_REMOVE":var r=e.friends.filter((function(e){return e.info._id!==t.payload._id}));return Object.assign({},e,{friends:r});case"ADD_NEW_POST":var i=[t.payload].concat(e.posts);return Object.assign({},e,{posts:i});case"DELETE_POST":var s=t.payload;return Object.assign({},e,{posts:s});case"CLEAR_USER_DATA":return Object.assign({},e,{_id:"",username:"",email:"",profileImg:"",notification:[],friends:[],posts:[]});default:return Object($.a)({},e)}},ut=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECTED_ID":return t.payload;default:return e}},dt=a(135),mt=[],Et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_SEARCH_RESULT":return t.payload;case"SET_SENT_REQUEST":case"SET_CANCEL_REQUEST":case"SET_ACCEPT_REQUEST":return e.map((function(e){return e._id===t.payload._id?Object.assign({},e,t.payload):Object.assign({},e)}));case"SET_REJECT_REQUEST":return e.filter((function(e){return e._id!==t.payload._id}));case"SET_REMOVE_FRIEND":return e.map((function(e){return e._id===t.payload._id?Object.assign({},e,t.payload):Object.assign({},e)}));case"CLEAR_SEARCH_RESULT":return[];default:return Object(dt.a)(e)}},pt={"friends.info":null,"friends.inbox":null},ft=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CHAT_INBOX":return{"state.friends.info":t.payload.data.friends.info,"state.friends.inbox":t.payload.data.friends.inbox};default:return Object($.a)({},e)}},gt={signal:null,inCall:!1,callInitiator:!1,callReceiving:!1},ht=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SAVE_SIGNAL":return Object.assign({},e,{signal:t.payload});case"INCALL_STATUS":return Object.assign({},e,{inCall:t.payload});case"INCALL_RECEIVING":return Object.assign({},e,{inCall:t.payload,callReceiving:t.payload});case"INCALL_INITIATE":return Object.assign({},e,{inCall:t.payload,callInitiator:t.payload});case"CLEAR_CALL_STATE":return Object.assign({},e,{signal:null,inCall:!1,callInitiator:!1,callReceiving:!1});default:return e}},vt=[],bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PUBLIC_POSTS":return t.payload;case"ADD_NEW_PUBLIC_POST":return[t.payload].concat(e);default:return Object(dt.a)(e)}},yt=function(){return Object(ot.d)(Object(ot.c)({login:st,selectedChat:ut,searchResult:Et,chat:ft,call:ht,publicPosts:bt}),Object(ot.a)(rt.a))},Ct=(a(344),yt());Ct.dispatch((function(e){L.a.get("/users/getLatestPublicPosts").then((function(t){console.log("[PROMISE-publicPosts]",t.data);var a=t.data;e({type:"SET_PUBLIC_POSTS",payload:a})})).catch((function(e){return console.log(e)}))})),localStorage.getItem("token")&&Ct.dispatch((function(e){L.a.get("/users/account",{headers:{"x-auth":U}}).then((function(t){console.log("[PROMISE-login-acc]",t.data);var a=t.data;a.hasOwnProperty("errors")?(localStorage.removeItem("token"),alert("session expired"),window.location.href="/users/login"):e(function(e){return{type:"SET_USER_DATA",payload:e}}(a))})).catch((function(e){return console.log(e)}))})),Ct.subscribe((function(){console.log(Ct.getState())}));var St=o.a.createElement(r.a,{store:Ct},o.a.createElement(ct,null));l.a.render(St,document.getElementById("root"))}},[[230,1,2]]]);
//# sourceMappingURL=main.5594c189.chunk.js.map